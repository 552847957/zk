<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Error Handing When Updating Pages</title><link rel="stylesheet" href="devguide.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.0"><link rel="start" href="index.html" title="ZK Developer's Guide"><link rel="up" href="ch10s13.html" title="Error Handling"><link rel="prev" href="ch10s13s01.html" title="Error Handling When Loading Pages"><link rel="next" href="ch10s14.html" title="Miscellaneous"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Error Handing When Updating Pages</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch10s13s01.html">Prev</a> </td><th width="60%" align="center">Error Handling</th><td width="20%" align="right"> <a accesskey="n" href="ch10s14.html">Next</a></td></tr></table><hr></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a name="id492923"></a>Error Handing When Updating Pages</h3></div></div></div><p>If an uncaught exception is thrown when updating a ZUML page (aka., when an event listener is executing), it is handled by the ZK Update Engine. By default, it simply asks the browser to show up an alert dialog to tell the user.</p><p>
</p><div><img src="images/10000000000002C10000011E30DFBEA1.png"></div><p>You can customize the error handling by specifying the error page in WEB-INF/zk.xml as follows. Refer to Appendix B in the Developer's Reference.</p><pre class="programlisting">&lt;!-- zk.xml --&gt;&lt;error-page&gt;    &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;        &lt;location&gt;/WEB-INF/sys/error.zul&lt;/location&gt;    &lt;/error-page&gt;</pre><p>Then, when an error occurs in an event listener, the ZK Update Engine creates a dialog by use of the error page you specified, /error/error.zul.</p><p>Like error handling in loading a ZUML page, you can specify multiple &lt;error-page&gt; elements. Each of them is associated with a different exception type (the value of &lt;exception-type&gt; element). When an error occurs, ZK will search the error pages one-by-one until the exception type matches.</p><p>In addition, ZK passes a set of request attributes to the error page to describe what happens. These attribute are as follows.</p><div class="informaltable"><a name="id492981"></a><table border="1"><colgroup><col><col></colgroup><thead><tr><th>
<p>Request Attribute</p>
</th><th>
<p>Type</p>
</th></tr></thead><tbody><tr><td>
<p>javax.servlet.error.exception_type</p>
</td><td>
<p>java.lang.Class</p>
</td></tr><tr><td>
<p>javax.servlet.error.message</p>
</td><td>
<p>java.lang.String</p>
</td></tr><tr><td>
<p>javax.servlet.error.exception</p>
</td><td>
<p>java.lang.Throwable</p>
</td></tr></tbody></table></div><p>For example, you can specify the following content as the error page.</p><pre class="programlisting">&lt;window title="Error ${requestScope['javax.servlet.error.status_code']}"width="400px" border="normal" mode="modal"&gt;    &lt;vbox&gt;    KillerApp encounters a fatal error, ${requestScope['javax.servlet.error.message']}. The error is recorded and we will look at it and fix it soon.        &lt;hbox style="margin-left:auto; margin-right:auto"&gt;                    &lt;button label="Continue" onClick="spaceOwner.detach()"/&gt;                        &lt;button label="Reload" onClick="Executions.sendRedirect(null)"/&gt;                    &lt;/hbox&gt;            &lt;/vbox&gt;        &lt;zscript&gt;        org.zkoss.util.logging.Log.lookup("Fatal").log(            requestScope.get("javax.servlet.error.exception"));            &lt;/zscript&gt;    <img src="images/10000000000002B2000000ED94D31A2A.png" align="right">&lt;/window&gt;</pre><p>Tip: The error page is created at the same desktop that causes the error, so you can retrieve the relevant information from it.</p><p>Tip: Since 2.3.1, ZK won't make the root window as modal automatically, since some applications may prefer not to use modal windows at all. If you prefer to use modal windows, you can specify the modal mode as shown in the previous example.</p><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id493126"></a>ZK Mobile Error When Updating Pages</h4></div></div></div><p>Each device type has its own set of error pages. To specify an error page for ZK mobile device (a mobile device supporting MIL), you have to specify the device-type element with mil as shown below.</p><pre class="programlisting">&lt;!-- zk.xml --&gt;&lt;error-page&gt;    &lt;device-type&gt;mil&lt;/device-type&gt;        &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;        &lt;location&gt;/WEB-INF/sys/error.zul&lt;/location&gt;    &lt;/error-page&gt;</pre><p>Tip: If the device-type element is omitted, ajax is assumed. In other words, it specifies an error page for Ajax browsers.</p><p>&lt;device-type&gt;ajax&lt;/device-type&gt; &lt;!-- ajax is the default --&gt;</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch10s13s01.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch10s13.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch10s14.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Error Handling When Loading Pages </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Miscellaneous</td></tr></table></div></body></html>
