<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Implement the org.zkoss.zk.ui.Richlet interface</title><link rel="stylesheet" href="devguide.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.0"><link rel="start" href="index.html" title="ZK Developer's Guide"><link rel="up" href="ch10s11.html" title="Richlets"><link rel="prev" href="ch10s11.html" title="Richlets"><link rel="next" href="ch10s11s02.html" title="Configure web.xml and zk.xml"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Implement the org.zkoss.zk.ui.Richlet interface</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch10s11.html">Prev</a> </td><th width="60%" align="center">Richlets</th><td width="20%" align="right"> <a accesskey="n" href="ch10s11s02.html">Next</a></td></tr></table><hr></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a name="id492374"></a>Implement the org.zkoss.zk.ui.Richlet interface</h3></div></div></div><p>All richlets must implement the org.zkoss.zk.ui.Richlet interface. To minimize the effects of implementing all methods, can extend the org.zkoss.zk.ui.GenericRichlet class instead. Then, when the specified URL is requested, the service method is called, and you can create the user interface then.</p><pre class="programlisting">package org.zkoss.zkdemo;import org.zkoss.zk.ui.Page;import org.zkoss.zk.ui.GenericRichlet;import org.zkoss.zk.ui.event.*;import org.zkoss.zul.*;public class TestRichlet extends GenericRichlet {    //Richlet//        public void service(Page page) {            page.setTitle("Richlet Test");                final Window w = new Window("Richlet Test", "normal", false);                new Label("Hello World!").setParent(w);                final Label l = new Label();                l.setParent(w);                final Button b = new Button("Change");                b.addEventListener(Events.ON_CLICK,                    new EventListener() {                            int count;                                public void onEvent(Event evt) {                                    l.setValue("" + ++count);                                    }                            });                    b.setParent(w);                w.setPage(page);            }    }</pre><p>Like servlets, you can implement the init and destroy methods to initialize and to destroy the richlet when it is loaded. Like servlet, a richlet is loaded once and serves all requests for the URL it is associated with.</p><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id492441"></a>One Richlet per URL</h4></div></div></div><p>Like servlets, a richlet is created and shared for the same URL. In other words, the richlet (at least the service method) must be thread-safe. On the other hands, components are not shareable. Each desktop has an independent set of components. Therefore, it is generally not a good idea to store components as a data member of a richlet.</p><p>There are many ways to solve this issue. A typical one is to use another class for holding the components for each desktop, as illustrated below.</p><pre class="programlisting">class MyApp { //one per desktop    Window _main;        MyApp(Page page) {            _main = new Window();                _main.setPage(page);            }    }</pre><p></p><p>class MyRichlet extends GenericRichlet {</p><pre class="programlisting">    public void service(Page page) {            new MyApp(page); //create and forget            }    }</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch10s11.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch10s11.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch10s11s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Richlets </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Configure web.xml and zk.xml</td></tr></table></div></body></html>
