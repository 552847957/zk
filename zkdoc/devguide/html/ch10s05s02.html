<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Listen to the onBookmarkChanged Event and Manipulate the Desktop Accordingly</title><link rel="stylesheet" href="devguide.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.0"><link rel="start" href="index.html" title="ZK Developer's Guide"><link rel="up" href="ch10s05.html" title="Browser's History Management"><link rel="prev" href="ch10s05s01.html" title="Add the Appropriate States to Browser's History"><link rel="next" href="ch10s05s03.html" title="A Simple Example"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Listen to the onBookmarkChanged Event and Manipulate the Desktop Accordingly</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch10s05s01.html">Prev</a> </td><th width="60%" align="center">Browser's History Management</th><td width="20%" align="right"> <a accesskey="n" href="ch10s05s03.html">Next</a></td></tr></table><hr></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a name="id491565"></a>Listen to the onBookmarkChanged Event and Manipulate the Desktop Accordingly</h3></div></div></div><p>After adding a state to the browser's history, users can then surf among these states such as pressing the BACK button to return the previous state. When the state is changed, ZK will notify the application by broadcasting the onBookmarkChanged event (an instance of the org.zkoss.zk.ui.event.BookmarkEvent class) to all root components in the desktop.</p><p>Unlike traditional multi-page Web applications, you have to manipulate the ZK desktop manually when the state is changed. It is application developer's job to manipulate the desktop to reflect the state that a bookmark represented.</p><p>To listen the onBookmarkChanged event, you can add an event listener to any page of the desktop, or to any of its root component.</p><pre class="programlisting">&lt;window onBookmarkChanged="goto(event.bookmark)"&gt;    &lt;zscript&gt;        void goto(String bookmark) {            if ("Step-2".equals(bookmark)) {                    ...//create components for Step 2                    } else { //empty bookmark                    ...//create components for Step 1                    }            &lt;/zscript&gt;    &lt;/window&gt;</pre><p>Like handling any other events, you can manipulate the desktop as you want, when the onBookmarkChanged event is received. A typical approach is to use the createComponents method of the org.zkoss.zk.ui.Executions class. In other words, you can represent each state with one ZUML page, and then use createComponents to create all components in it when onBookmarkChanged is received.</p><pre class="programlisting">if ("Step-2".equals(bookmark)) {    //1. Remove components, if any, representing the previous state        try {            self.getFellow("replacable").detach();            } catch (ComponentNotFoundException ex) {            //not created yet            }        //2. Creates components belonging to Step 2        Executions.createComponents("/bk/step2.zul", self, null);    }</pre></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch10s05s01.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch10s05.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch10s05s03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Add the Appropriate States to Browser's History </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> A Simple Example</td></tr></table></div></body></html>
