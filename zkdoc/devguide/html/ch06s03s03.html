<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>How to Use each and forEachStatus Variables in Event Listeners</title><link rel="stylesheet" href="devguide.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.0"><link rel="start" href="index.html" title="ZK Developer's Guide"><link rel="up" href="ch06s03.html" title="Iterative Evaluation"><link rel="prev" href="ch06s03s02.html" title="The forEachStatus Variable"><link rel="next" href="ch06s04.html" title="Load on Demand"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">How to Use each and forEachStatus Variables in Event Listeners</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch06s03s02.html">Prev</a> </td><th width="60%" align="center">Iterative Evaluation</th><td width="20%" align="right"> <a accesskey="n" href="ch06s04.html">Next</a></td></tr></table><hr></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a name="id475073"></a>How to Use each and forEachStatus Variables in Event Listeners</h3></div></div></div><p>It is a bit tricky to use the forEach and forEachStatus variables in event listeners, because they are available only in the Component Creation Phase<sup>[<a name="id475084" href="#ftn.id475084" class="footnote">33</a>]</sup>. Thus, the following sample is incorrect: when the onClick listener is called, the each variable is no longer available.</p><pre class="programlisting">&lt;window title="Countries" border="normal" width="100%"&gt;    &lt;zscript&gt;&lt;![CDATA[        String[] countries = {            "China", "France", "Germany", "United Kindom", "United States"};            ]]&gt;&lt;/zscript&gt;        &lt;hbox&gt;            &lt;button label="${each}" forEach="${countries}"                    onClick="alert(each)"/&gt; &lt;!-- incorrect!! --&gt;                &lt;/hbox&gt;    &lt;/window&gt;</pre><p>Notice that the button's label is assigned correctly because it is done at the same phase &#8211; the Component Creation Phase.</p><p>Also notice that you cannot use EL expressions in the event listener. For example, the following codes fail to execute because the onClick listener is not a legal Java codes (i.e., EL expressions are ignored in zscript).</p><pre class="programlisting">&lt;button label="${each}" forEach="${countries}"        onClick="alert(${each})"/&gt; &lt;!-- incorrect!! --&gt;        </pre><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id475138"></a>A Solution: custom-attributes</h4></div></div></div><p>The solution is that we have to store the content of each (and forEachStatus) somewhere such that its content is still available when the listener executes. You can store its content anywhere, but there is a simple way to do it as follows.</p><pre class="programlisting">&lt;window title="Countries" border="normal" width="100%"&gt;    &lt;zscript&gt;&lt;![CDATA[        String[] countries = {            "China", "France", "Germany", "United Kindom", "United States"};            ]]&gt;&lt;/zscript&gt;        &lt;hbox&gt;            &lt;button label="${each}" forEach="${countries}"                onClick="alert(self.getAttribute(&amp;quot;country&amp;quot;))"&gt;                    &lt;custom-attributes country="${each}"/&gt;                    &lt;/button&gt;            &lt;/hbox&gt;    &lt;/window&gt;</pre><p>Like button's label, the properties of custom attributes are evaluated in the Component Creation Phase, so you can use each there. Then, it is stored to a custom attribute which will last as long as the component exists (or until being removed programmingly).</p></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.id475084" href="#id475084" class="para">33</a>] </sup>Refer to the Component Lifecycle chapter for more details.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch06s03s02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch06s03.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch06s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">The forEachStatus Variable </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Load on Demand</td></tr></table></div></body></html>
