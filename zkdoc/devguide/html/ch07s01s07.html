<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Input Controls</title><link rel="stylesheet" href="devguide.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.0"><link rel="start" href="index.html" title="ZK Developer's Guide"><link rel="up" href="ch07s01.html" title="Basic Components"><link rel="prev" href="ch07s01s06.html" title="Audio"><link rel="next" href="ch07s01s08.html" title="Calendar"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Input Controls</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch07s01s06.html">Prev</a> </td><th width="60%" align="center">Basic Components</th><td width="20%" align="right"> <a accesskey="n" href="ch07s01s08.html">Next</a></td></tr></table><hr></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a name="id478563"></a>Input Controls</h3></div></div></div><p>A set of input controls are supported in the XUL component set: textbox, intbox, decimalbox, doublebox, datebox, combobox, and bandbox. They are used to let users input different types of data.</p><p>
</p><div><img src="images/1000000000000160000000A52BD72F03.png"></div><p>
</p><pre class="programlisting">&lt;zk&gt;    &lt;textbox/&gt;        &lt;datebox/&gt;    &lt;/zk&gt;</pre><p>Tip: combobox and bandbox are special input boxes. They shares the common properties described here. Their unique features will be discussed later in the Comboboxes and Bandboxes section.</p><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id478598"></a>The type Property</h4></div></div></div><p>You could specify the type property with password for the textbox components, such that what user has entered won't be shown.</p><pre class="programlisting">Username: &lt;textbox/&gt;Password: &lt;textbox type="password"/&gt;</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id478614"></a>The format Property</h4></div></div></div><p>You could control the format of an input control by the format filed. The default is null. For datebox, it means yyyy/MM/dd. For intbox and decimalbox, it means no formating at all.</p><pre class="programlisting">&lt;datebox format="MM/dd/yyyy"/&gt;&lt;decimalbox format="#,##0.##"/&gt;</pre><p>Like any other properties, you could change the format dynamically, as depicted below.</p><pre class="programlisting">&lt;datebox id="db"/&gt;&lt;button label="set MM-dd-yyyy" onClick="db.setFormat(&amp;quot;MM-dd-yyyy&amp;quot;)"/&gt;</pre><p>Mouseless Entrydatebox</p><div class="itemizedlist"><ul type="disc"><li><p>Alt+DOWN to pop up the calendar.</p></li><li><p>LEFT, RIGHT, UP and DOWN to change the selected day from the calendar.</p></li><li><p>ENTER to activate the selection by copying the selected day to the datebox control.</p></li><li><p>Alt+UP or ESC to give up the selection and close the calendar.</p></li></ul></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id478688"></a>Constraints</h4></div></div></div><p>You could specify what value to accept for input controls by use of the constraint property. It could a combination of no positive, no negative, no zero, no empty, no future, no past, no today, and a regular expression. The first three constraints are applicable only to intbox and decimalbox. The constraints of no future, no past, and no today are applicable only to datebox. The constraint of no empty is applicable to any type of components. The constraint of regular expressions is applicable only to String-type input components, such as textbox., combobox and bandbox.</p><p>To specify two or more constraints, use comma to separate them as follows.</p><pre class="programlisting">&lt;intbox constraint="no negative,no zero"/&gt;</pre><p>To specify a regular expression, you could have to use / to enclose the regular expression as follows. </p><pre class="programlisting">&lt;textbox constraint="/.+@.+\.[a-z]+/"/&gt;</pre><p>Notes:</p><div class="itemizedlist"><ul type="disc"><li><p>The above statement is XML, so do not use \\ to specify a backslash. On the other hand, it is necessary, if writing in Java.</p></li></ul></div><pre class="programlisting">new Textbox().setContraint("/.+@.+\\.[a-z]+/");</pre><div class="itemizedlist"><ul type="disc"><li><p>It is allowed to mix regular expression with other constraints by separating them with comma.</p></li></ul></div><p>You prefer to display an application dependent message instead of default one, you could append the constraint with colon and the message you want to display when failed.</p><pre class="programlisting">&lt;textbox constraint="/.+@.+\.[a-z]+/: e-mail address only"/&gt;</pre><p>&lt;datebox constraint="no empty, no future: now or never"/&gt;</p><p>Notes:</p><div class="itemizedlist"><ul type="disc"><li><p>The error message, if specified, must be the last element and start with colon.</p></li><li><p>To support multilingual, you could use the l function as depicted in the Internationalization chapter.</p></li></ul></div><pre class="programlisting">&lt;textbox constraint="/.+@.+\.[a-z]+/: ${c:l('err.email.required')}"/&gt;</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id478811"></a>Custom Constraints</h4></div></div></div><p>If you want more sophisticated constraint, you could specify an object which implements the org.zkoss.zul.Constraint interface.</p><pre class="programlisting">&lt;window title="Custom Constraint"&gt;    &lt;zscript&gt;&lt;![CDATA[    Constraint ctt = new Constraint() {    public void validate(Component comp, Object value) throws WrongValueException {            if (value =e= null || ((Integer)value).intValue() &lt; 100)                    throw new WrongValueException(comp, "At least 100 must be specified");                }    }    ]]&gt;&lt;/zscript&gt;        &lt;intbox constraint="${ctt}"/&gt;    &lt;/window&gt;</pre><p>You could implement your constraint into a Java class, say my.EmailValidator, then:</p><pre class="programlisting">&lt;?taglib uri="http://www.zkoss.org/dsp/web/core.dsp.tld" prefix="c"?&gt;&lt;textbox constraint="${c:new('my.EmailValidator')}"/&gt;</pre><div class="sect4" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a name="id478848"></a>org.zkoss.zk.ui.WrongValueException</h5></div></div></div><p>In the above example, we use org.zkoss.zk.ui.WrongValueException to denote an error. As depicted, you have to specify the first argument with the component that causes the error, and then the second argument with the error message.</p><p>You could throw this exception anytime, such as when an onChange event is received as follows.</p><pre class="programlisting">&lt;textbox&gt;<img src="images/100000000000010500000030B13C47C7.png" align="right">    &lt;attribute name="onChange"&gt;            if (!self.value.equals("good")) {                    self.value = "try again";                        throw new WrongValueException(self, "Not a good answer!");                    }            &lt;/attribute&gt;    &lt;/textbox&gt;</pre></div><div class="sect4" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a name="id478888"></a>Custom Way to Display the Error Messages</h5></div></div></div><p>Instead of the default error box as shown in the previous example, you can provide a custom look by implementing the org.zkoss.zul.CustomConstraint interface with Constraint. CustomConstraint has one method, showCustomError, which is called when an exception is thrown or when the validation is correct. Here is an example,</p><pre class="programlisting">&lt;window title="Custom Constraint" border="normal"&gt;    &lt;zscript&gt;&lt;![CDATA[    class MyConst implements Constraint, CustomConstraint {    //Constraint//        public void validate(Component comp, Object value) {            if (value == null || ((Integer)value).intValue() &lt; 100)                    throw new WrongValueException(comp, "At least 100 must be specified");                }        //CustomConstraint//        public void showCustomError(Component comp, WrongValueException ex) {            errmsg.setValue(ex != null ? ex.getMessage(): "");            }    }Constraint ctt = new MyConst();    ]]&gt;&lt;/zscript&gt;        &lt;hbox&gt;            Enter a number at least 100:                &lt;intbox constraint="${ctt}"/&gt;                &lt;label id="errmsg"/&gt;        <img src="images/100000000000023D00000039116921E8.png" align="right">    &lt;/hbox&gt;    &lt;/window&gt;</pre></div><div class="sect4" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a name="id478930"></a>Improve Responsiveness</h5></div></div></div><p>The responsiveness can be improved by validating more constraints at the client. To do this, you have to implement the org.zkoss.zul.ClientConstraint interface with Constraint. If you have done all validations at the client, you can return true for the isClientComplete method, and then there will be no server callback at all.</p><p>You can also customize the display of the error message with pure JavaScript codes a the client by providing a function called Validate_errorbox. For example,</p><pre class="programlisting">&lt;script type="text/javascript"&gt;&lt;![CDATA[    //Running at the browser        window.Validate_errorbox = function (id, boxid, msg) {            var html = '&lt;div style="display:none;position:absolute" id="'        </pre><p>+boxid+'"&gt;'+zk.encodeXML(msg, true)+'&lt;/div&gt;';</p><pre class="programlisting">            document.body.insertAdjacentHTML("afterbegin", html);return $e(boxid);}            ]]&gt;&lt;/script&gt;</pre><p>Note: script specifies the script codes running at the browser, while zscript specifies codes running at the server.</p><p>Note: If CustomConstraint is also implemented, ClientConstraint will be ignored since all validations are done at the server. In other words, if you want to use ClientConstraint to improve responsiveness, overriding Validate_errorbox is the only way to customize the display of the error messsage.</p></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id478987"></a>The onChange Event</h4></div></div></div><p>An input control notifies the application with the onChange event if its content is changed by the user.</p><p>Notice that, when the onChange's event listener is invoked, the value has been set. Thus, it is too late if you want to reject illegal value in the onChange's event listener, unless you restore the value properly. Rather, it is recommended to use a constraint as described in the Custom Constraints section.</p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id479005"></a>The onChanging event</h4></div></div></div><p>An input control also notifies the application with the onChanging event, when user is changing the content.</p><p>Notice that, when the onChanging's listener is invoked, the value is not set yet. In other worlds, the value property still remain in the old value. To retrieve what the user is entering, you have to access the value property of the event as follows.</p><pre class="programlisting">&lt;grid&gt;    &lt;rows&gt;            &lt;row&gt;The onChanging textbox:                     &lt;textbox onChanging="copy.value = event.value"/&gt;&lt;/row&gt;                    &lt;row&gt;Instant copy:                    &lt;textbox id="copy" readonly="true"/&gt;&lt;/row&gt;                &lt;/rows&gt;    &lt;/grid&gt;</pre><p>It is too early if you want to reject illegal value in the onChanging's event listener, because user may not complete the change yet. Rather, it is recommended to use a constraint as described in the Custom Constraints section.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch07s01s06.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch07s01.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch07s01s08.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Audio </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Calendar</td></tr></table></div></body></html>
