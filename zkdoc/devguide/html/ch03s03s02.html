<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Variable and Functions Defined in zscript</title><link rel="stylesheet" href="devguide.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.0"><link rel="start" href="index.html" title="ZK Developer's Guide"><link rel="up" href="ch03s03.html" title="The ID Space"><link rel="prev" href="ch03s03s01.html" title="Namespace and ID Space"><link rel="next" href="ch03s04.html" title="Events"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Variable and Functions Defined in zscript</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch03s03s01.html">Prev</a> </td><th width="60%" align="center">The ID Space</th><td width="20%" align="right"> <a accesskey="n" href="ch03s04.html">Next</a></td></tr></table><hr></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a name="id420391"></a>Variable and Functions Defined in zscript</h3></div></div></div><p>In addition to executing codes, you could define variables and functions in the zscript element directly as depicted below.</p><pre class="programlisting">&lt;window id="A&gt;    &lt;zscript&gt;            Object myvar = new LinkedList();                void myfunc() {                    ...                    }            &lt;/zscript&gt;        ...        &lt;button label="add" onClick="myvar.add(some)"/&gt;        &lt;button label="some" onClick="myfunc()"/&gt;    &lt;/window&gt;</pre><p>The variables and methods defined in zscript are stored in the interpreter of the corresponding scripting language.</p><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id420422"></a>zscript and EL Expressions</h4></div></div></div><p>Like namespaces<sup>[<a name="id420430" href="#ftn.id420430" class="footnote">24</a>]</sup>, variable defined in zscript are all visible to EL expressions.</p><pre class="programlisting">&lt;window&gt;    &lt;zscript&gt;        String var = "abc";        self.setVariable("var2", "xyz", true);        &lt;/zscript&gt;        ${var} ${var2}    &lt;/window&gt;</pre><p>is equivalent to</p><pre class="programlisting">&lt;window&gt;abc xyz&lt;/window&gt;</pre><p>Notice that variables defined in zscript has the higher priority than those defined in the namespace.</p><pre class="programlisting">&lt;window&gt;    &lt;zscript&gt;        String var = "abc";        self.setVariable("var", "xyz", true);        &lt;/zscript&gt;        ${var}    &lt;/window&gt;</pre><p>is equivalent to</p><pre class="programlisting">&lt;window&gt;abc&lt;/window&gt;</pre><p>It is sometimes confusing, if you declare a component later as shown in the following example.</p><pre class="programlisting">&lt;window&gt;    &lt;zscript&gt;        String var = "abc";        &lt;/zscript&gt;        &lt;label id="var" value="A label"/&gt;        ${var.value} &lt;!-- Wrong! var is "abc", not the label --&gt;    &lt;/window&gt;</pre><p>Therefore, it is suggested to use some naming pattern to avoid the confusion. For example, you can prefix all interpreter variables with zs_.</p><p>In additions, you shall use local variables if possible. A local variable is declared with the class name, and it is visible only to a particular scope of zscript codes.</p><pre class="programlisting">&lt;zscript&gt;Date now = new Date();&lt;/zscript&gt;</pre><p>Furthermore, you can make a local variable invisible to EL expressions by enclosing it with curly braces as follows.</p><pre class="programlisting">&lt;zscript&gt;{ //create a new logic scope    String var = "abc"; //visible only inside of the enclosing curly brace    }&lt;/zscript&gt;</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id420539"></a>Multi-Scope Interpreters</h4></div></div></div><p>Depending on the implementation, an interpreter might have exactly one logical scope, or one logic scope per ID space to store these variables and methods. For sake of description, we call them the single-scope and multi-scope interpreters, respectively.</p><p>Java interpreter (BeanShell) is a typical multi-scope interpreter<sup>[<a name="id420556" href="#ftn.id420556" class="footnote">25</a>]</sup>. It creates an interpreter-dependent scope for each ID space. For example, two logical scopes are created for window A and B, respectively in the following example. Therefore, var2 is visible only to window B, while var1 is visible to both window A and B in the following example.</p><pre class="programlisting">&lt;window id="A"&gt;    &lt;zscript&gt;var1 = "abc";&lt;/zscript&gt;        &lt;window id="B"&gt;            &lt;zscript&gt;var2 = "def";&lt;/zscript&gt;            &lt;/window&gt;    &lt;/window&gt;</pre><div class="sect4" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a name="id420579"></a>Java Interpreter (BeanShell)</h5></div></div></div><p>With Java Interpreter (BeanShell), you can declare an interpreter variable local to the logical scope of the nearest ID space (i.e., a window) by specifying the class name as below,</p><pre class="programlisting">&lt;window id="A"&gt;    &lt;window id="B"&gt;            &lt;zscript&gt;            String b = "local to window B";            &lt;/zscript&gt;            &lt;/window&gt;    &lt;/window&gt;</pre><p>The following is a more sophisticated example which will generate abc def.</p><pre class="programlisting">&lt;window id="A"&gt;    &lt;zscript&gt;        var1 = var2 = "abc";        &lt;/zscript&gt;        &lt;window id="B"&gt;            &lt;zscript&gt;            Object var1 = "123";        var2 = "def";        var3 = "xyz";            &lt;/zscript&gt;            &lt;/window&gt;        ${var1} ${var2} ${var3}    &lt;/window&gt;</pre><p>where Object var1 = "123" actually creates a variable local to window B since the class name, Object, is specified. On the other hand, var2 = "def" causes the interpreter to look up any variable called var2 defined in the current scope or any scope in the upper layers. Since var2 was defined in window A, the variable is overridden. In the case of var3 = "xyz", a variable local to window B is created, since window A doesn't define any variable called var3.</p></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id420621"></a>Single-Scope Interpreters</h4></div></div></div><p>Ruby, Groovy and JavaScript interpreters don't support multi-scope yet<sup>[<a name="id420630" href="#ftn.id420630" class="footnote">26</a>]</sup>. It means all variables defined in, say, Ruby are stored in one logical scope (per interpreter). Thus, the interpreter variables defined in one window override those defined in another window if they are in the same page. To avoid confusion, you could prefix the variable names with special prefix denoting the window.</p><p>Tip: Each page has its own interpreter to evaluate zscript codes. If a desktop has multiple pages, then it might have multiple instances of the interpreters (per scripting language). </p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id420650"></a>Multiple scripting Languages in One Page</h4></div></div></div><p>Each scripting language is associated with one interpreter. Thus, variables and methods defined in one language are not visible to another language. For example, var1 and var2 belong to two different interpreters in the following example.</p><pre class="programlisting">&lt;zscript language="Java"&gt;    var1 = 123;    &lt;/zscript&gt;&lt;zscript language="JavaScript"&gt;    var2 = 234;    &lt;/zscript&gt;</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a name="id420672"></a>getVariable versus getZScriptVariable</h4></div></div></div><p>Variables defined in the namespace can be retrieved by use of the getVariable method.</p><p>On the other hand, variables defined in zscript is part of the interpret that interprets it. They are not a part of any namespace. In other words, you can not retrieve them by use of the getVariable method.</p><pre class="programlisting">&lt;zscript&gt;    var1 = 123; //var1 belongs to the interpreter, not any namespace        page.getVariable("var1"); //returns null    &lt;/zscript&gt;</pre><p>Instead, you have to use getZScriptVariable to retrieve variables defined in zscript. Similarly, you can use getZScriptClass to retrieve classes and getZScriptMethod to retrieve methods defined in zscript. These methods will iterate through all loaded interpreters until the specified one is found.</p><p>If you want to search a particular interpreter, you can use the getInterpreter method to retrieve the interpreter first, as follows.</p><pre class="programlisting">page.getInterpreter("JavaScript").getVariable("some"); //interpreter for JavaScriptpage.getInterpreter(null).getVariable("some"); //interpreter for default language</pre></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.id420430" href="#id420430" class="para">24</a>] </sup>org.zkoss.zk.scripting.Namespace</p></div><div class="footnote"><p><sup>[<a name="ftn.id420556" href="#id420556" class="para">25</a>] </sup>Java interpreter supports multi-scope after 2.3.1 (included) and before 2.2.1 (included).</p></div><div class="footnote"><p><sup>[<a name="ftn.id420630" href="#id420630" class="para">26</a>] </sup>We may support it in the near future.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03s03s01.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch03s03.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch03s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Namespace and ID Space </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Events</td></tr></table></div></body></html>
