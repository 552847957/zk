<html>
<head>
<title>com.potix.xawk</title>
</head>

<body>
<p>An Awk-like regular-expression-driven XML parser.</p>
<hr>
Author: Tom M. Yeh<br>
Contributors: <br>
Copyright (C) 2002 Potix Corporation. All Rights Reserved. 
<hr>
<h2>Overview</h2>

<p>The parsing of a xml is controlled by a set of patterns and scripts. These 
 patterns and scripts can be expressed in another XML, called xawk file.</p>
<p><a href="xawk.xml">Here is an example</a> that describes the syntax of the 
 awk file.<br>
 <a href="ex-xawk.xml">Here is a xml file</a> described in a 'meta' language. 
</p>
<hr width="50%">
<h3>The xawk file</h3>

<dl>
 <dt>&lt;init&gt;</dt>
 <dd>Optional and at most one. Any BeanShell script that shall be executed before 
  parsing (to do the init).</dd>
 <dt>&lt;cleanup&gt;</dt>
 <dd>Optional and multiple. Any BeanShell script that shall be executed after 
  parsing (to do the cleanup).</dd>
 <dt>&lt;rule&gt;</dt>
 <dt>&lt;condition&gt;</dt>
 <dd>Optional and at most one. Any BeanShell script will be executed and tested 
  before executing any &lt;rule&gt;'s scipt. It is called global condition. It 
  behaves as if it is written in every rule, and before the rule's condition.</dd>
 <dt>&lt;begin&gt;</dt>
 <dd>Optional and at most one. Any BeanShell script that shall be executed before 
  the begin script, if any, in every rule. It is called global begin. It behaves 
  as if it is written in every rule, and before the rule's begin.</dd>
 <dt>&lt;end&gt;</dt>
 <dd>Optional and multiple. Any BeanShell script that shall be executed after 
  the end script, if any, in every rule. It is called global end. It behaves as 
  if it is written in every rule, and after the rule's end.</dd>
 <dt>&lt;rule&gt;</dt>
 <dd> 
  <dl>
   <dt>&lt;pattern&gt;</dt>
   <dd>Optional and multiple. Any regular expression. Unlike &lt;begin&gt; and 
    &lt;condition&gt; , you might specify multiple patterns. And, it is said
    'matches' if any pattern matches(i.e., OR). If no pattern is specified,
    it always matches.</dd>
   <dt>&lt;condition&gt;</dt>
   <dd>Optional and at most one. Any BenShell script. It is called the rule
   condition. The condition is tested after any pattern matches.</dd>
   <dt>&lt;begin&gt;</dt>
   <dd>Optional and at most one. Any BeanShell script that shall be executed before 
    any child elements are parsed. It is executed only if any patterns matches
    and the condition returns true.</dd>
   <dt>&lt;end&gt;</dt>
   <dd>Optional and at most one. Any BeanShell script that shall be executed after 
    all child elements are parsed. It is executed only if any patterns matches
    and the condition returns true.</dd>
  </dl>
 </dd>
</dl>

<p>In summary, the begin and end of a rule is executed if and only if
any of rule's patterns matches, the global condition returns true, and, finally,
 the rule condition also returns true. In other words, if no pattern matches
 in a rule, neither global nor rule condition will be tested.</p>

<p>Thus, specifying the global condition is different from specifying a rule without 
 any pattern, as follows. Since a rule without pattern matches all elements,
 the condition is tested against all elements.
<pre><code>&lt;rule&gt;
 &lt;condition&gt;xxx&lt;/condition&gt;
...</code></pre>

<p>Note: for each path, the pattern and condition is tested only once.
If both begin and end are specified, the test is evaluated before begin,
and the result is re-used for end. In other words,
begin and end are both executed or both not, even though begin might
change some status.</p>

<hr width="50%">
<h3>Code samples</h3>

<pre><code>Xawk xawk = new Xawk();
xawk.set("target", target); //optional: initial any variables you want
xawk.config(xawk_file);
Object result = xawk.parse(xml_to_parse);
  //return the value of the result variable, or null if no such variable
</code></pre>

<hr width="50%">
<h3>Built-in Variable</h3>

<dl>
	<dt><code>the</code></dt>
	<dd><a href="Context.html"><code>com.potix.xawk.Context</code></a>
	<p>The context of the element being processed.</p></dd>
</dl>

<hr width="50%">
<h3>Debug</h3>

<p>Turn on: <code>com.potix.xawk=DEBUG</code></p>
<hr>
<h2>Histroy</h2>
<table width="100%">
 <tr>
  <td>September 2-3, 2002</td>
  <td>Tom M. Yeh</td>
  <td>Version 0.1. Based on iDom builder. Future extension: implement SAX
  handler to parse XML directly.</td>
 </tr>
 <tr>
  <td>September 4, 2002</td>
  <td>Tom M. Yeh</td>
  <td>Version 0.2. Redefine the syntax.</td>
 </tr>
 <tr>
  <td>September 7, 2002</td>
  <td>Tom M. Yeh</td>
  <td>Version 0.3. Adds rule/global conditions and context's stack.</td>
 </tr>
</table>
</body>
</html>
