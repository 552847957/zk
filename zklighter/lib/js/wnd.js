_z='zul.wnd';if(!zk.$import(_z)){try{_zkpk=zk.$package(_z);
zPkg.load("zul.wgt");zul.wnd.Window=zk.$extends(zul.Widget,{_mode:"embedded",_border:"none",_minheight:100,_minwidth:200,_zIndex:0,$init:function(){this._fellows={};this.$supers("$init",arguments);this.listen("onClose",this,null,-1000);this.listen("onMove",this,null,-1000);this.listen("onZIndex",this,null,-1000);this._skipper=new zul.wnd.Skipper(this)},getMode:function(){return this._mode},setMode:function(a){if(this._mode!=a){this._mode=a;this._updateDomOuter()}},doOverlapped:function(){this.setMode("overlapped")},doPopup:function(){this.setMode("popup")},doHighlighted:function(){this.setMode("highlighted")},doModal:function(){this.setMode("modal")},doEmbedded:function(){this.setMode("embedded")},_doOverlapped:function(){var c=this.getPosition(),b=this.getNode();if(!c&&!b.style.top&&!b.style.left){var a=zDom.revisedOffset(b);b.style.left=a[0]+"px";b.style.top=a[1]+"px"}else{if(c=="parent"){this._posByParent()}}zDom.makeVParent(b);this._syncShadow();this._updateDomPos();if(this.isRealVisible()){zDom.cleanVisibility(b);this.setTopmost()}this._makeFloat()},_doModal:function(){var g=this.getPosition(),f=this.getNode();if(g=="parent"){this._posByParent()}zDom.makeVParent(f);this._syncShadow();this._updateDomPos(true);if(!g){var c=zk.parseInt(f.style.top),e=zDom.innerY();if(e){var a=c-e;if(a>100){f.style.top=c-(a-100)+"px"}}else{if(c>100){f.style.top="100px"}}}var d=this.isRealVisible();if(d){zDom.cleanVisibility(f);this.setTopmost()}this._syncMask();this._mask=new zk.eff.FullMask({id:this.uuid+"$mask",anchor:this._shadow.getBottomElement(),zIndex:this._zIndex,stackup:zk.ie6Only,visible:d});if(d){this._prevmodal=zk.currentModal;var b=zk.currentModal=this;this._prevfocus=zk.currentFocus;this.focus(0)}this._makeFloat()},_posByParent:function(){var d=this.getNode(),a=zDom.revisedOffset(d.parentNode),c=zk.parseInt(d.style.left),b=zk.parseInt(d.style.top);this._offset=a;d.style.left=a[0]+zk.parseInt(d.style.left)+"px";d.style.top=a[1]+zk.parseInt(d.style.top)+"px"},_syncShadow:function(){if(this._mode=="embedded"){if(this._shadow){this._shadow.destroy();this._shadow=null}}else{if(!this._shadow){this._shadow=new zk.eff.Shadow(this.getNode(),{left:-4,right:4,top:-2,bottom:3,stackup:!zk.gecko})}this._shadow.sync()}},_syncMask:function(){if(this._mask){this._mask.sync(this._shadow.getBottomElement())}},_hideShadow:function(){var a=this._shadow;if(a){a.hide()}},_makeFloat:function(){var a=this.getSubnode("cap");if(a&&!this._drag){a.style.cursor="move";var b=this.$class;this._drag=new zk.Draggable(this,null,{handle:a,overlay:true,stackup:true,starteffect:b._startmove,ghosting:b._ghostmove,endghosting:b._endghostmove,ignoredrag:b._ignoremove,endeffect:b._aftermove})}},_updateDomPos:function(c){var d=this.getNode(),h=this._pos;if(h=="parent"||(!h&&!c)){return}var j=d.style;j.position="absolute";var g=j.left,f=j.top;zDom.center(d,h);var b=this._shadow;if(h&&b){var a=b.opts,e=d.offsetLeft,i=d.offsetTop;if(h.indexOf("left")>=0&&a.left<0){j.left=(e-a.left)+"px"}else{if(h.indexOf("right")>=0&&a.right>0){j.left=(e-a.right)+"px"}}if(h.indexOf("top")>=0&&a.top<0){j.top=(i-a.top)+"px"}else{if(h.indexOf("bottom")>=0&&a.bottom>0){j.top=(i-a.bottom)+"px"}}}this._syncShadow();if(g!=j.left||f!=j.top){this._fireOnMove()}},getTitle:function(){return this._title},setTitle:function(a){if(this._title!=a){this._title=a;this._updateDomOuter()}},getBorder:function(){return this._border},setBorder:function(a){if(!a||"0"==a){a="none"}if(this._border!=a){this._border=a;this._updateDomOuter()}},getPosition:function(){return this._pos},setPosition:function(a){if(this._pos!=a){this._pos=a;if(this.desktop&&this._mode!="embedded"){this._updateDomPos()}}},getMinheight:function(){return this._minheight},setMinheight:function(a){if(this._minheight!=a){this._minheight=a}},getMinwidth:function(){return this._minwidth},setMinwidth:function(a){if(this._minwidth!=a){this._minwidth=a}},isClosable:function(){return this._closable},setClosable:function(a){if(this._closable!=a){this._closable=a;this._updateDomOuter()}},isSizable:function(){return this._sizable},setSizable:function(a){if(this._sizable!=a){this._sizable=a;this._updateDomOuter()}},isMaximized:function(){return this._maximized},setMaximized:function(a){if(this._maximized!=a){this._maximized=a;this._updateDomOuter()}},isMaximizable:function(){return this._maximizable},setMaximizable:function(a){if(this._maximizable!=a){this._maximizable=a;this._updateDomOuter()}},isMinimized:function(){return this._minimized},setMinimized:function(a){if(this._minimized!=a){this._minimized=a;this._updateDomOuter()}},isMinimizable:function(){return this._minimizable},setMinimizable:function(a){if(this._minimizable!=a){this._minimizable=a;this._updateDomOuter()}},getContentStyle:function(){return this._cntStyle},setContentStyle:function(a){if(this._cntStyle!=a){this._cntStyle=a;this._updateDomOuter()}},getContentSclass:function(){return this._cntSclass},setContentSclass:function(a){if(this._cntSclass!=a){this._cntSclass=a;this._updateDomOuter()}},_updateDomOuter:function(){this.rerender(this._skipper)},onClose:function(){if(!this.inServer){this.parent.removeChild(this)}},onMove:function(a){this._left=a.data.left;this._top=a.data.top},onZIndex:function(a){this._syncShadow();this._syncMask()},onSize:_zkf=function(){this._hideShadow();if(this.isMaximized()){}this._fixHgh();this._fixWdh();this._syncShadow()},onVisible:_zkf,onFloatUp:function(b){if(!this.isVisible()||this._mode=="embedded"){return}if(this._mode=="popup"){for(var a;b;b=b.parent){if(b==this){if(!a){this.setTopmost()}return}a=a||b.isFloating_()}this.setVisible(false);this.fire("onOpen",false)}else{for(;b;b=b.parent){if(b==this){this.setTopmost();return}if(b.isFloating_()){return}}}},_fixWdh:zk.ie7?function(){if(this._mode=="embedded"||this._mode=="popup"||!this.isRealVisible()){return}var g=this.getNode(),f=this.getSubnode("cave").parentNode,c=g.style.width,b=zDom.firstChild(g,"DIV"),a=b&&this.getSubnode("cap")?zDom.nextSibling(b,"DIV"):null,e=zDom.lastChild(g,"DIV");if(!c||c=="auto"){var d=zDom.padBorderWidth(f.parentNode)+zDom.padBorderWidth(f.parentNode.parentNode);if(b){b.firstChild.style.width=f.offsetWidth+d+"px"}if(a){a.firstChild.firstChild.style.width=Math.max(0,f.offsetWidth-(zDom.padBorderWidth(a)+zDom.padBorderWidth(a.firstChild)-d))+"px"}if(e){e.firstChild.style.width=f.offsetWidth+d+"px"}}else{if(b){b.firstChild.style.width=""}if(a){a.firstChild.style.width=""}if(e){e.firstChild.style.width=""}}}:zk.$void,_fixHgh:function(){if(!this.isRealVisible()){return}var b=this.getNode(),a=b.style.height;cave=this.getSubnode("cave"),cvh=cave.style.height;if(a&&a!="auto"){if(zk.ie6Only){cave.style.height="0px"}zDom.setOffsetHeight(cave,this._offsetHeight(b))}else{if(cvh&&cvh!="auto"){if(zk.ie6Only){cave.style.height="0px"}cave.style.height=""}}},_offsetHeight:function(e){var b=e.offsetHeight-1-this._titleHeight(e);if(this._mode!="embedded"&&this._mode!="popup"){var d=this.getSubnode("cave"),c=zDom.lastChild(e,"DIV"),a=this.getSubnode("cap");b-=c.offsetHeight;if(d){b-=zDom.padBorderHeight(d.parentNode)}if(a){b-=zDom.padBorderHeight(a.parentNode)}}return b-zDom.padBorderHeight(e)},_titleHeight:function(c){var b=this.getSubnode("cap"),a=zDom.firstChild(c,"DIV");return b?b.offsetHeight+a.offsetHeight:this._mode!="embedded"&&this._mode!="popup"?zDom.nextSibling(a,"DIV").offsetHeight:0},_fireOnMove:function(c){var g=this._pos,b=this.getNode(),a=zk.parseInt(b.style.left),f=zk.parseInt(b.style.top);if(g=="parent"){var e=zDom.vparent(b);if(e){var d=zDom.reviseOffset(e);a-=d[0];f-=d[1]}}this.fire("onMove",{left:a+"px",top:f+"px",keys:c},{ignorable:true})},setHeight:function(a){this.$supers("setHeight",arguments);if(this.desktop){this._fixHgh();this._syncShadow();zWatch.fireDown("beforeSize",null,this);zWatch.fireDown("onSize",null,this)}},setWidth:function(a){this.$supers("setWidth",arguments);if(this.desktop){this._fixWdh();this._syncShadow();zWatch.fireDown("beforeSize",null,this);zWatch.fireDown("onSize",null,this)}},setDomVisible_:function(){this.$supers("setDomVisible_",arguments);this._syncShadow();this._syncMask()},setZIndex:function(){this.$supers("setZIndex",arguments);this._syncShadow();this._syncMask()},focus:function(c){if(this.desktop){var b=this.caption;for(var a=this.firstChild;a;a=a.nextSibling){if(a!=b&&a.focus(c)){return true}}return b&&b.focus(c)}return false},getZclass:function(){var a=this._zclass;return a!=null?a:"z-window-"+this._mode},onChildAdded_:function(a){this.$supers("onChildAdded_",arguments);if(a.$instanceof(zul.wgt.Caption)){this.caption=a}},onChildRemoved_:function(a){this.$supers("onChildRemoved_",arguments);if(a==this.caption){this.caption=null}},domStyle_:function(c){var a=this.$supers("domStyle_",arguments),b=this.isVisible();if((!c||!c.visible)&&b&&this.isMinimized()){a="display:none;"+a}if(this._mode!="embedded"){a=(b?"position:absolute;visibility:hidden;":"position:absolute;")+a}return a},bind_:function(){this.$supers("bind_",arguments);var a=this.$class;var b=this._mode;zWatch.listen("onSize",this);zWatch.listen("onVisible",this);if(b!="embedded"){zWatch.listen("onFloatUp",this);this.setFloating_(true);if(b=="modal"||b=="highlighted"){this._doModal()}else{this._doOverlapped()}}},unbind_:function(){var d=this.getNode();d.style.visibility="hidden";if(this._shadow){this._shadow.destroy();this._shadow=null}if(this._drag){this._drag.destroy();this._drag=null}if(this._mask){this._mask.destroy();this._mask=null}zDom.undoVParent(d);zWatch.unlisten("onFloatUp",this);zWatch.unlisten("onSize",this);zWatch.unlisten("onVisible",this);this.setFloating_(false);if(zk.currentModal==this){zk.currentModal=this._prevmodal;var e=this._prevfocus;if(e){e.focus(0)}this._prevfocus=this._prevmodal=null}var f=this.$class;for(var c=["close","max","min"],b=3;--b>=0;){var a=c[b],g=this["e"+a];if(g){this["e"+a]=null;zEvt.unlisten(g,"click",f[a+"click"]);zEvt.unlisten(g,"mouseover",f[a+"over"]);zEvt.unlisten(g,"mouseout",f[a+"out"])}}this.$supers("unbind_",arguments)},doClick_:function(a){switch(a.nativeTarget){case this.getSubnode("close"):this.fire("onClose");break;case this.getSubnode("max"):break;case this.getSubnode("min"):break}a.stop();this.$supers("doClick_",arguments)},doMouseOver_:function(a){switch(a.nativeTarget){case this.getSubnode("close"):zDom.addClass(this.getSubnode("close"),this.getZclass()+"-close-over");break;case this.getSubnode("max"):var c=this.getZclass(),b=this.isMaximized()?" "+c+"-maxd-over":"";zDom.addClass(this.getSubnode("max"),c+"-max-over"+b);break;case this.getSubnode("min"):zDom.addClass(this.getSubnode("min"),this.getZclass()+"-min-over");break}this.$supers("doMouseOver_",arguments)},doMouseOut_:function(b){switch(b.nativeTarget){case this.getSubnode("close"):zDom.rmClass(this.getSubnode("close"),this.getZclass()+"-close-over");break;case this.getSubnode("max"):var c=this.getZclass(),a=this.getSubnode("max");if(this.isMaximized()){zDom.rmClass(a,c+"-maxd-over")}zDom.rmClass(a,c+"-max-over");break;case this.getSubnode("min"):zDom.rmClass(this.getSubnode("min"),this.getZclass()+"-min-over");break}this.$supers("doMouseOut_",arguments)}},{_startmove:function(b){var a=b.node;if(a.style.top&&a.style.top.indexOf("%")>=0){a.style.top=a.offsetTop+"px"}if(a.style.left&&a.style.left.indexOf("%")>=0){a.style.left=a.offsetLeft+"px"}},_ghostmove:function(i,g,l){var b=i.control,a=i.node;b._hideShadow();var j=zDom.firstChild(a,"DIV"),f=zDom.nextSibling(j,"DIV"),c=j.cloneNode(true),k=f.cloneNode(true),e='<div id="zk_wndghost" class="z-window-move-ghost" style="position:absolute;top:'+g[1]+"px;left:"+g[0]+"px;width:"+zDom.offsetWidth(a)+"px;height:"+zDom.offsetHeight(a)+"px;z-index:"+a.style.zIndex+'"><dl></dl></div>';document.body.insertAdjacentHTML("afterBegin",e);i._wndoffs=g;a.style.visibility="hidden";var d=a.offsetHeight-j.offsetHeight-f.offsetHeight;a=zDom.$("zk_wndghost");a.firstChild.style.height=zDom.revisedHeight(a.firstChild,d)+"px";a.insertBefore(c,a.firstChild);a.insertBefore(k,a.lastChild);return a},_endghostmove:function(c,a){var b=c.node;a.style.top=a.offsetTop+b.offsetTop-c._wndoffs[1]+"px";a.style.left=a.offsetLeft+b.offsetLeft-c._wndoffs[0]+"px";document.body.style.cursor=""},_ignoremove:function(c,e,a){var b=c.node,d=c.control;switch(zEvt.target(a)){case d.getSubnode("close"):case d.getSubnode("max"):case d.getSubnode("min"):return true}if(!d.isSizable()||(b.offsetTop+4<e[1]&&b.offsetLeft+4<e[0]&&b.offsetLeft+b.offsetWidth-4>e[0])){return false}return true},_aftermove:function(b,a){b.node.style.visibility="";var c=b.control;c._syncShadow();c._fireOnMove(zEvt.keyMetaData(a))}});zul.wnd.Skipper=zk.$extends(zk.Skipper,{$init:function(a){this._w=a},restore:function(){this.$supers("restore",arguments);var a=this._w;if(a._mode!="embedded"){a._updateDomPos();a._syncShadow()}}});
(_zkwg=_zkpk.Window).prototype.className='zul.wnd.Window';_zkmd={};
_zkmd['default']=function(c,k){var b=this.getZclass(),a=this.uuid,h=this.getTitle(),j=this.caption,l=this.getContentStyle(),e=this.getContentSclass(),f=this.getMode(),d="embedded"!=f&&"popup"!=f,g="normal"!=this.getBorder()?"-noborder":"";c.push("<div",this.domAttrs_(),">");if(j||h){c.push('<div class="',b,'-tl"><div class="',b,'-tr"></div></div><div class="',b,'-hl"><div class="',b,'-hr"><div class="',b,'-hm"><div id="',a,'$cap" class="',b,'-header">');if(j){j.redraw(c)}else{if(this.isClosable()){c.push('<div id="',a,'$close" class="',b,"-icon ",b,'-close"></div>')}if(this.isMaximizable()){c.push('<div id="',a,'$max" class="',b,"-icon ",b,"-max");if(this.isMaximized()){c.push(" ",b,"-maxd")}c.push('"></div>')}if(this.isMinimizable()){c.push('<div id="'+a,'$min" class="',b,"-icon ",b,'-min"></div>')}c.push(zUtl.encodeXML(h))}c.push("</div></div></div></div>")}else{if(d){c.push('<div class="',b,"-tl",g,'"><div class="',b,"-tr",g,'"></div></div>')}}if(d){c.push('<div class="',b,"-cl",g,'"><div class="',b,"-cr",g,'"><div class="',b,"-cm",g,'">')}c.push('<div id="',a,'$cave" class="');if(e){c.push(e," ")}c.push(b,"-cnt",g,'"');if(l){c.push(' style="',l,'"')}c.push(">");if(!k){for(var i=this.firstChild;i;i=i.nextSibling){if(i!=j){i.redraw(c)}}}c.push("</div>");if(d){c.push('</div></div></div><div class="',b,"-bl",g,'"><div class="',b,"-br",g,'"></div></div>')}c.push("</div>")};
zkmld(_zkwg,_zkmd);
}finally{zPkg.end(_z);}}