_z='zul.inp';if(!zk.$import(_z)){try{_zkpk=zk.$package(_z);
zul.inp.InputWidget=zk.$extends(zul.Widget,{_maxlength:0,_cols:0,_tabindex:-1,_type:"text",$init:function(){this._pxLateBlur=this.proxy(this._lateBlur);this.$supers("$init",arguments)},getType:function(){return this._type},isMultiline:function(){return false},getValue:function(){return this._value},setValue:function(b,a){if(a){this.clearErrorMessage(true)}else{if(b==this._lastRawValVld){return}else{b=this._validate(b)}}if((!b||!b.error)&&(a||this._value!=b)){this._value=b;if(this.einp){this.einp.value=b=this.coerceToString_(b);if(a){this.einp.defaultValue=b}}}},getName:function(){return this._name},setName:function(a){if(this._name!=a){this._name=a;if(this.einp){this.einp.name=a}}},isDisabled:function(){return this._disabled},setDisabled:function(a){if(this._disabled!=a){this._disabled=a;if(this.einp){this.einp.disabled=a;var b=this.getZclass(),c=a?"addClass":"rmClass";zDom[c](this.getNode(),b+"-disd");zDom[c](this.einp,b+"-text-disd")}}},isReadonly:function(){return this._readonly},setReadonly:function(a){if(this._readonly!=a){this._readonly=a;if(this.einp){this.einp.readOnly=a;zDom[a?"addClass":"rmClass"](this.einp,this.getZclass()+"-readonly")}}},getCols:function(){return this._cols},setCols:function(a){if(this._cols!=a){this._cols=a;if(this.einp){if(this.isMultiline()){this.einp.cols=a}else{this.einp.size=a}}}},getMaxlength:function(){return this._maxlength},setMaxlengths:function(a){if(this._maxlength!=a){this._maxlength=a;if(this.einp&&!this.isMultiline()){this.einp.maxLength=a}}},getTabindex:function(){return this._tabindex},setTabindex:function(a){if(this._tabindex!=a){this._tabindex=a;if(this.einp){this.einp.tabIndex=a}}},innerAttrs_:function(){var b="",a;if(this.isMultiline()){a=this._cols;if(a>0){b+=' cols="'+a+'"'}}else{b+=' value="'+this.coerceToString_(this.getValue())+'"';b+=' type="'+this._type+'"';a=this._cols;if(a>0){b+=' size="'+a+'"'}a=this._maxlength;if(a>0){b+=' maxlength="'+a+'"'}}a=this._tabindex;if(a>=0){b+=' tabindex="'+a+'"'}a=this._name;if(a){b+=' name="'+a+'"'}if(this._disabled){b+=' disabled="disabled"'}if(this._readonly){b+=' readonly="readonly"'}return b},_areaText:function(){return zUtl.encodeXML(this.coerceToString_(this._value))},setConstraint:function(a){if(typeof a=="string"){this._cst=new zul.inp.SimpleConstraint(a)}else{if(a==true){this._cst=true}else{this._cst=a}}if(this._cst){delete this._lastRawValVld}},getConstraint:function(){return this._cst},doFocus_:function(a){if(!zDom.tag(zEvt.target(a))||!this.domFocus_()){return}if(this.isListen("onChanging")){this._lastChg=this.einp.value;this._tidChg=setInterval(this.proxy(this._onChanging),500)}zDom.addClass(this.einp,this.getZclass()+"-focus")},doBlur_:function(a){this._stopOnChanging();zDom.rmClass(this.einp,this.getZclass()+"-focus");this.domBlur_();if(!zk.alerting){setTimeout(this._pxLateBlur,0)}},_doSelect:function(c){if(this.isListen("onSelection")){var f=this.einp,d=zDom.getSelectionRange(f),a=d[0],g=d[1];this.fire("onSelection",{start:a,end:g,selected:f.value.substring(a,g)})}},_lateBlur:function(){if(this.shallUpdate_(zk.currentFocus)){this._updateChange()}},shallUpdate_:function(a){return !a||!zUtl.isAncestor(this,a)},getErrorMesssage:function(){return this._errmsg},showErrorMessage:function(a){this.clearErrorMessage(true,true);this._markError(a,null,true)},clearErrorMessage:function(c,b){var a=this._errbox;if(a){this._errbox=null;a.destroy()}if(!b){this._errmsg=null;zDom.rmClass(this.einp,this.getZclass()+"-text-invalid")}if(c){delete this._lastRawValVld}},coerceFromString_:function(a){return a},coerceToString_:function(a){return a||""},_markError:function(e,d,c){this._errmsg=e;if(this.desktop){zDom.addClass(this.einp,this.getZclass()+"-text-invalid");var a=this._cst,b;if(a){b=a.showCustomError;if(b){b=b.call(a,this,e)}}if(!b){this._errbox=this.showError_(e)}if(!c){this.fire("onError",{value:d,message:e})}}},validate_:function(a){if(this._cst){if(this._cst==true){return}return this._cst.validate(this,a)}},_validate:function(a){zul.inp.validating=true;try{var c=a;if(typeof c=="string"||c==null){c=this.coerceFromString_(c);if(c){var b=c.error;if(b){this.clearErrorMessage(true);this._markError(b,c);return c}}}if(!this.desktop){this._errmsg=null}else{this.clearErrorMessage(true);var b=this.validate_(c);if(b){this._markError(b,c);return{error:b}}else{this._lastRawValVld=a}}return c}finally{zul.inp.validating=false}},showError_:function(b){var a=new zul.inp.Errorbox();a.show(this,b);return a},_updateChange:function(){if(zul.inp.validating){return}var b=this.einp,c=b.value;if(c==this._lastRawValVld){return}var a=this._errmsg,d=this._validate(c);if(!d||!d.error){b.value=c=this.coerceToString_(d);if(a||c!=b.defaultValue){this._value=d;b.defaultValue=c;this.fire("onChange",this._onChangeData(c),null,150)}}},_onChanging:function(){var b=this.einp,c=this.valueEnter__||b.value;if(this._lastChg!=c){this._lastChg=c;var a=this.valueSel_;this.valueSel_=null;this.fire("onChanging",this._onChangeData(c,a==c),{ignorable:1},100)}},_onChangeData:function(b,c){var a={value:b,start:zDom.getSelectionRange(this.einp)[0]};if(c){a.bySelectBack=true}return a},_stopOnChanging:function(){if(this._tidChg){clearInterval(this._tidChg);this._tidChg=this._lastChg=this.valueEnter_=this.valueSel_=null}},focus:function(a){if(this.isVisible()&&this.canActivate({checkOnly:true})){zDom.focus(this.einp,a);return true}return false},domClass_:function(c){var b=this.$supers("domClass_",arguments),a=this.getZclass();if(!c||!c.zclass){if(this._disabled){b+=" "+a+"-disd"}}if(!c||!c.input){if(this._disabled){b+=" "+a+"-text-disd"}if(this._readonly){b+=" "+a+"-readonly"}}return b},bind_:function(){this.$supers("bind_",arguments);var a=this.einp=this.getSubnode("inp")||this.getNode();zEvt.listen(a,"focus",this.proxy(this.doFocus_,"_pxFocus"));zEvt.listen(a,"blur",this.proxy(this.doBlur_,"_pxBlur"));zEvt.listen(a,"select",this.proxy(this._doSelect,"_pxSelect"))},unbind_:function(){this.clearErrorMessage(true);var a=this.einp;zEvt.unlisten(a,"focus",this._pxFocus);zEvt.unlisten(a,"blur",this._pxBlur);zEvt.unlisten(a,"select",this._pxSelect);this.einp=null;this.$supers("unbind_",arguments)},doKeyDown_:function(a){var d=a.keyCode,c=a.keys;if(d==9&&!c.altKey&&!c.ctrlKey&&!c.shiftKey&&this._tabbable){var b=zDom.getSelectionRange(inp),e=inp.value;e=e.substring(0,b[0])+"\t"+e.substring(b[1]);inp.value=e;e=b[0]+1;zDom.setSelectionRange(inp,e,e);a.stop();return}if((d==13&&this.isListen("onOK"))||(d==27&&this.isListen("onCancel"))){this._stopOnChanging();this._updateChange()}},doKeyUp_:function(){if(this.isMultiline()){var a=this._maxlength;if(a>0){var b=this.einp,c=b.value;if(c!=b.defaultValue&&c.length>a){b.value=c.substring(0,a)}}}this.$supers("doKeyUp_",arguments)}});
(_zkwg=_zkpk.InputWidget).prototype.className='zul.inp.InputWidget';zul.inp.Errorbox=zk.$extends("zul.wgt.Popup",{$init:function(){this.$supers("$init",arguments);this.setWidth("260px");this.setSclass("z-errbox")},show:function(a,b){this.parent=a;this.msg=b;this.insertHTML(document.body,"beforeEnd");this.open(a,null,"end_before",{overflow:true})},destroy:function(){this.close();var a=this.getNode();this.unbind_();zDom.remove(a);this.parent=null},bind_:function(){this.$supers("bind_",arguments);var a=zul.inp.Errorbox;this._drag=new zk.Draggable(this,null,{starteffect:zk.$void,endeffect:a._enddrag,ignoredrag:a._ignoredrag,change:a._change});zWatch.listen("onScroll",this)},unbind_:function(){this._drag.destroy();zWatch.unlisten("onScroll",this);this.$supers("unbind_",arguments);this._drag=null},onScroll:function(a){if(a){this.position(this.parent,null,"end_before",{overflow:true});this._fixarrow()}},setDomVisible_:function(b,c){this.$supers("setDomVisible_",arguments);var a=this._stackup;if(a){a.style.display=c?"":"none"}},doMouseMove_:function(a){var c=a.nativeTarget;if(c==this.getSubnode("c")){var d=a.data.pageY,b=zk.parseInt(zDom.getStyle(c,"padding-right"));offs=zDom.revisedOffset(c);if(d>=offs[1]&&d<offs[1]+b){zDom.addClass(c,"z-errbox-close-over")}else{zDom.rmClass(c,"z-errbox-close-over")}}else{this.$supers("doMouseMove_",arguments)}},doMouseOut_:function(a){var b=a.nativeTarget;if(b==this.getSubnode("c")){zDom.rmClass(b,"z-errbox-close-over")}else{this.$supers("doMouseOut_",arguments)}},doClick_:function(a){var b=a.nativeTarget;if(b==this.getSubnode("c")&&zDom.hasClass(b,"z-errbox-close-over")){this.parent.clearErrorMessage(true,true)}else{this.$supers("doClick_",arguments);this.parent.focus(0)}},open:function(){this.$supers("open",arguments);this.setTopmost();this._fixarrow()},prologHTML_:function(a){var b=this.uuid;a.push('<div id="',b);a.push('$a" class="z-errbox-left z-arrow" title="');a.push(zUtl.encodeXML(mesg.GOTO_ERROR_FIELD));a.push('"><div id="',b,'$c" class="z-errbox-right z-errbox-close"><div class="z-errbox-center">');a.push(zUtl.encodeXML(this.msg,{multiline:true}));a.push("</div></div></div>")},onFloatUp:function(c){if(c==this){this.setTopmost();return}if(!c||c==this.parent||!this.isVisible()){return}var b=this,a=c;while((b=b.parent)&&!b.isFloating_()){}for(;a&&!a.isFloating_();a=a.parent){}if(b==a){var d=c.getNode();if(d){this._uncover(d)}}},_uncover:function(a){var h=zDom.cmOffset(a),e=this.getNode(),c=zDom.cmOffset(e);if(zDom.isOverlapped(h,[a.offsetWidth,a.offsetHeight],c,[e.offsetWidth,e.offsetHeight])){var j=this.parent.getNode(),i;var g=zDom.cmOffset(j),d=j.offsetHeight,b=g[1]+d;i=h[1]+a.offsetHeight<=b?b:g[1]-e.offsetHeight;var f=zDom.toStyleOffset(e,0,i);e.style.top=f[1]+"px";this._fixarrow()}},_fixarrow:function(){var e=this.parent.getNode(),f=this.getNode(),g=this.getSubnode("a"),b=zDom.revisedOffset(e),h=zDom.revisedOffset(f);var c=h[0]-b[0],a=h[1]-b[1],d;if(c>=e.offsetWidth-2){d=a<-10?"ld":a>=e.offsetHeight-2?"lu":"l"}else{if(c<0){d=a<-10?"rd":a>=e.offsetHeight-2?"ru":"r"}else{d=a<0?"d":"u"}}g.className="z-errbox-left z-arrow-"+d}},{_enddrag:function(b){var a=b.control;a.setTopmost();a._fixarrow()},_ignoredrag:function(b,c,a){return zEvt.target(a)==b.control.getSubnode("c")&&zDom.hasClass(b.control.getSubnode("c"),"z-errbox-close-over")},_change:function(d){var c=d.control,a=c._stackup;if(a){var b=c.getNode();a.style.top=b.style.top;a.style.left=b.style.left}c._fixarrow()}});
(_zkwg=_zkpk.Errorbox).prototype.className='zul.inp.Errorbox';zul.inp.SimpleConstraint=zk.$extends(zk.Object,{$init:function(e,d,f){if(typeof e=="string"){this._flags={};this._init(e)}else{if(e){this._flags=typeof e=="number"?this._cvtNum(e):e}this._regex=typeof d=="string"?new RegExp(d):d;this._errmsg=f}},_init:function(d){l_out:for(var c=0,b=0,a=d.length;b>=0;c=b+1){for(;;++c){if(c>=a){return}var f=d.charAt(c);if(f=="/"){for(b=++c;;++b){if(b>=a){b=-1;break}f=d.charAt(b);if(f=="/"){break}if(f=="\\"){++b}}this._regex=new RegExp(b>=0?d.substring(c,b):d.substring(c));continue l_out}if(f==":"){this._errmsg=d.substring(c+1).trim();return}if(!zk.isWhitespace(f)){break}}var e;for(b=c;;++b){if(b>=a){e=d.substring(c);b=-1;break}var f=d.charAt(b);if(f==","||f==":"||f==";"||f=="/"){e=d.substring(c,b);if(f==":"||f=="/"){--b}break}}this.parseConstraint_(e.trim().toLowerCase())}},parseConstraint_:function(a){var b=this._flags;if(a=="no positive"){b.NO_POSITIVE=true}else{if(a=="no negative"){b.NO_NEGATIVE=true}else{if(a=="no zero"){b.NO_ZERO=true}else{if(a=="no empty"){b.NO_EMPTY=true}else{if(a=="no future"){b.NO_FUTURE=true}else{if(a=="no past"){b.NO_PAST=true}else{if(a=="no today"){b.NO_TODAY=true}else{if(a=="strict"){b.STRICT=true}}}}}}}}},_cvtNum:function(a){var b={};if(a&1){b.NO_POSITIVE=b.NO_FUTURE=true}if(a&2){b.NO_NEGATIVE=b.NO_PAST=true}if(a&4){b.NO_ZERO=b.NO_TODAY=true}if(a&256){b.NO_EMPTY=true}if(a&512){b.STRICT=true}return b},validate:function(i,h){var e=this._flags,g=this._errmsg;switch(typeof h){case"string":if(e.NO_EMPTY&&(!h||!h.trim())){return msgzul.EMPTY_NOT_ALLOWED}var d=this._regex;if(d&&!d.test(h)){return g||msgzul.ILLEGAL_VALUE}if(e.STRICT&&h){}return;case"number":if(h>0){if(e.NO_POSITIVE){return g||this._msgNumDenied()}}else{if(h==0){if(e.NO_ZERO){return g||this._msgNumDenied()}}else{if(e.NO_NEGATIVE){return g||this._msgNumDenied()}}}return}if(h&&h.getFullYear){var c=zUtl.today(),h=new Date(h.getFullYear(),h.getMonth(),h.getDate());if(h>c){if(e.NO_FUTURE){return g||this._msgDateDenied()}}else{if(h==c){if(e.NO_TODAY){return g||this._msgDateDenied()}}else{if(e.NO_PAST){return g||this._msgDateDenied()}}}return}if(h&&h.compareTo){var a=h.compareTo(0);if(a>0){if(e.NO_POSITIVE){return g||this._msgNumDenied()}}else{if(a==0){if(e.NO_ZERO){return g||this._msgNumDenied()}}else{if(e.NO_NEGATIVE){return g||this._msgNumDenied()}}}return}if(!h&&e.NO_EMPTY){return g||msgzul.EMPTY_NOT_ALLOWED}},_msgNumDenied:function(){var a=this._flags;if(a.NO_POSITIVE){return a.NO_ZERO?a.NO_NEGATIVE?NO_POSITIVE_NEGATIVE_ZERO:msgzul.NO_POSITIVE_ZERO:a.NO_NEGATIVE?msgzul.NO_POSITIVE_NEGATIVE:msgzul.NO_POSITIVE}else{if(a.NO_NEGATIVE){return a.NO_ZERO?msgzul.NO_NEGATIVE_ZERO:msgzul.NO_NEGATIVE}else{if(a.NO_ZERO){return msgzul.NO_ZERO}}}return msgzul.ILLEGAL_VALUE},_msgDateDenied:function(){var a=this._flags;if(a.NO_FUTURE){return a.NO_TODAY?a.NO_PAST?NO_FUTURE_PAST_TODAY:msgzul.NO_FUTURE_TODAY:a.NO_PAST?msgzul.NO_FUTURE_PAST:msgzul.NO_FUTURE}else{if(a.NO_PAST){return a.NO_TODAY?msgzul.NO_PAST_TODAY:msgzul.NO_PAST}else{if(a.NO_TODAY){return msgzul.NO_TODAY}}}return msgzul.ILLEGAL_VALUE}});
zul.inp.Textbox=zk.$extends(zul.inp.InputWidget,{_value:"",_rows:1,isMultiline:function(){return this._multiline},setMultiline:function(a){if(this._multiline!=a){this._multiline=a;this.rerender()}},isTabbable:function(){return this._tabbable},setTabbable:function(a){this._tabbable=a},getRows:function(){return this._rows},setRows:function(a){if(this._rows!=a){this._rows=a;if(this.einp&&this.isMultiline()){this.einp.rows=a}}},setType:function(a){if(this._type!=a){this._type=a;if(this.einp){this.einp.type=a}}},innerAttrs_:function(){var a=this.$supers("innerAttrs_",arguments);if(this._multiline){a+=' rows="'+this._rows+'"'}return a},getZclass:function(){var a=this._zclass;return a!=null?a:"z-textbox"}});
(_zkwg=_zkpk.Textbox).prototype.className='zul.inp.Textbox';_zkmd={};
_zkmd['default']=function(a){if(this.isMultiline()){a.push("<textarea",this.domAttrs_(),this.innerAttrs_(),">",this._areaText(),"</textarea>")}else{a.push("<input",this.domAttrs_(),this.innerAttrs_(),"/>")}};
zkmld(_zkwg,_zkmd);zul.inp.FormatWidget=zk.$extends(zul.inp.InputWidget,{getFormat:function(){return this._format},setFormat:function(a){if(this._format!=a){this._format=a;if(this.einp){this.einp.value=this.coerceToString_(this._value)}}}});
(_zkwg=_zkpk.FormatWidget).prototype.className='zul.inp.FormatWidget';zul.inp.Intbox=zk.$extends(zul.inp.FormatWidget,{coerceFromString_:function(a){if(!a){return null}var b=zNumFormat.unformat(this._format,a),c=parseInt(b.raw);if(b.raw!=""+c){return{error:zMsgFormat.format(msgzul.INTEGER_REQUIRED,a)}}if(b.divscale){c=Math.round(c/Math.pow(10,b.divscale))}return c},coerceToString_:function(b){var a=this._format;return a?zNumFormat.format(a,b):b?""+b:""},getZclass:function(){var a=this._zclass;return a!=null?a:"z-intbox"}});
(_zkwg=_zkpk.Intbox).prototype.className='zul.inp.Intbox';_zkmd={};
_zkmd['default']=function(a){a.push("<input",this.domAttrs_(),this.innerAttrs_(),"/>")};
zkmld(_zkwg,_zkmd);zul.inp.Doublebox=zk.$extends(zul.inp.Intbox,{coerceFromString_:function(a){if(!a){return null}var b=zNumFormat.unformat(this._format,a),c=parseFloat(b.raw);if(b.raw!=""+c&&b.raw.indexOf("e")<0){return{error:zMsgFormat.format(msgzul.NUMBER_REQUIRED,a)}}if(b.divscale){c=Math.round(c/Math.pow(10,b.divscale))}return c},getZclass:function(){var a=this._zclass;return a!=null?a:"z-doublebox"}});
(_zkwg=_zkpk.Doublebox).prototype.className='zul.inp.Doublebox';_zkmd={};
_zkmd['default']=[_zkpk.Intbox,'default'];zkmld(_zkwg,_zkmd);
}finally{zPkg.end(_z);}}